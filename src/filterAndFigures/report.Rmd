---
title: "filtering report"
#code-author: MaartenPostuma
#date: 23-07-2019
output:
  html_document:
    df_print: paged
params:
  dir: "vcf/"
  rmd: "report.Rmd"
  args: myargs
---

#### author: `r system("whoami",inter=T)`
#### date: `r system("date",intern=T)`


```{r setup, include=FALSE}
#setwd("./output")
chooseCRANmirror(graphics=FALSE, ind=33)
args <- commandArgs(TRUE)
usePackage <- function(p) 
{
  if (!is.element(p, installed.packages()[,1]))
    install.packages(p, dep = TRUE)
  require(p, character.only = TRUE)
}
usePackage("ggplot2")
usePackage("ggpubr")
usePackage("knitr")
usePackage("ggdendro")
usePackage("ggrepel")
usePackage("rmarkdown")

options(stringsAsFactors = FALSE)

knitr::opts_chunk$set(echo = FALSE)
options(tinytex.verbose = TRUE)
knitr::opts_knit$set(root.dir = '../../')
```

This report contains all the information needed to make descisions about your filtering steps.

# Filter Steps {.tabset .tabset-fade .tabset-pills}

## First Steps

The distribution of individual missingness

```{r fig.cap="Fig.1: Histogram of the fraction of missingness across individuals, red line indicates the cutoff used in filtering step 2"}
print()
indCoverage<-read.table(paste0(params$args[1],"filters/missingIndvs.imiss"),h=T)
cutOff<-as.numeric(system("cat config.yaml | grep 'individual_missingness'| cut -f2 -d :"),intern=T)
numberOfIndividuals<-system(paste0("cat ",params$args[1],"/stackFiles/popmapFiltered.tsv"),intern=T)
ggplot(indCoverage,aes(x=F_MISS))+geom_histogram(col="black",fill="lightblue",binwidth=0.025)+
  ggtitle(numberOfIndividuals)+ylab("fraction missing")+
  theme_light()+geom_vline(xintercept=cutOff,col="red")

```

